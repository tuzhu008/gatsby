webpackJsonp([24041335701291],{656:function(e,a){e.exports={data:{markdownRemark:{html:'<h2 id="在不同的静态站点主机上部署的教程"><a href="#%E5%9C%A8%E4%B8%8D%E5%90%8C%E7%9A%84%E9%9D%99%E6%80%81%E7%AB%99%E7%82%B9%E4%B8%BB%E6%9C%BA%E4%B8%8A%E9%83%A8%E7%BD%B2%E7%9A%84%E6%95%99%E7%A8%8B" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>在不同的静态站点主机上部署的教程</h2>\n<ul>\n<li><a href="/docs/deploy-gatsby/#amazon-s3-and-cloudfront">S3/Cloudfront</a></li>\n<li><a href="/docs/deploy-gatsby/#github-pages">GitHub Pages</a></li>\n<li><a href="/docs/deploy-gatsby/#gitlab-pages">GitLab Pages</a></li>\n<li><a href="/docs/deploy-gatsby/#heroku">Heroku</a></li>\n</ul>\n<h2 id="amazon-s3-and-cloudfront"><a href="#amazon-s3-and-cloudfront" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Amazon S3 and Cloudfront</h2>\n<p>If you decide to host your Gatsby site on S3 with Cloudfront as CDN, you should\nchange the “Origin Domain Name” on the Cloudfront panel with the real URL of\nyour S3 bucket: <strong>examplewebsite.com.s3-website-eu-west-1.amazonaws.com</strong>\nreplacing the default URL suggested by Amazon\n<strong>examplewebsite.com.s3.amazonaws.com</strong>.</p>\n<p>Without this change,\n<a href="https://forums.aws.amazon.com/message.jspa?messageID=314454">S3 doesn’t look for index.html files when serving “clean urls”</a>.</p>\n<h2 id="github-pages"><a href="#github-pages" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>GitHub Pages</h2>\n<h3 id="部署项目页面"><a href="#%E9%83%A8%E7%BD%B2%E9%A1%B9%E7%9B%AE%E9%A1%B5%E9%9D%A2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>部署项目页面</h3>\n<p>您可以在 GitHub Pages 上部署站点，或者不使用自定义域名。\n如果您选择使用默认的设置(不使用自定义域名)，或者您创建一个项目站点，\n您将需要使用<a href="/docs/path-prefix/">路径前缀</a>来设置您的站点。</p>\n<p>在 Github 上，你可以在 Github 的帐号和组织中获得一个站点，\n以及无限的项目站点。所以你很有可能会创建一个项目网站。\n如果你没有计划使用的 Github 现有的存储库，那么现在就花时间在 Github上 创建一个新的存储库。</p>\n<h3 id="使用-npm-包-gh-pages-来部署"><a href="#%E4%BD%BF%E7%94%A8-npm-%E5%8C%85-gh-pages-%E6%9D%A5%E9%83%A8%E7%BD%B2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>使用 NPM 包 <code>gh-pages</code> 来部署</h3>\n<p>首先添加 <strong>gh-pages</strong> 作为你的站点的一个 <code>devDependency</code>，然后运行</p>\n<div class="gatsby-highlight">\n      <pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> gh-pages --save-dev\n</code></pre>\n      </div>\n<p>或</p>\n<div class="gatsby-highlight">\n      <pre class="language-bash"><code>yarn add gh-pages --dev\n</code></pre>\n      </div>\n<p>然后添加一个 <code>deploy</code> 脚本到 <code>package.json</code> 文件中，用来部署项目：</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code><span class="token string">"scripts"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>\n  <span class="token string">"deploy"</span><span class="token punctuation">:</span> <span class="token string">"gatsby build --prefix-paths &amp;&amp; gh-pages -d public"</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>在 <code>gatsby-config.js</code> 中，设置 <code>pathPrefix</code> 为被添加到你的网站的链接路径。\n<code>pathPrefix</code> 应该是你的存储库的项目名称。(ex.\n<code>https://github.com/username/project-name</code> -  <code>pathPrefix</code> 应该是\n<code>/project-name</code>)。参见\n<a href="/docs/path-prefix/">路径前缀的文档页面</a>.</p>\n<div class="gatsby-highlight">\n      <pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  pathPrefix<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`/project-name`</span></span><span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n</code></pre>\n      </div>\n<p>如果您还没有在您的工作的 gatsby 站点 repo 中初始化 git 存储库，\n那么在您的项目中使用 <code>git init</code> 在您的项目中设置 git。\n然后告诉 Gatsby 在哪里部署您的站点，通过使用 https 或 ssh 添加 git 远程地址。\n下面是如何使用 <code>git remote add origin git@github.com:username/project-name.git</code>。</p>\n<p>现在运行 <code>yarn deploy</code> 或 <code>npm run deploy</code>。\n在 GitHub page <code>https://username.github.io/project-name/</code> 预览变化。\n你还可以在 GitHub 下的 <code>Settings</code> > <code>GitHub Pages</code> 找到你的网站链接。</p>\n<h3 id="部署一个用户组织的网站"><a href="#%E9%83%A8%E7%BD%B2%E4%B8%80%E4%B8%AA%E7%94%A8%E6%88%B7%E7%BB%84%E7%BB%87%E7%9A%84%E7%BD%91%E7%AB%99" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>部署一个用户/组织的网站</h3>\n<p>与项目页面不同的是，GitHub 上的用户/组织站点都位于特别的存储库中，专门用于站点文件。\n站点必须从存储库的 <code>master</code> 分支发布，这意味着站点源文件应该保存在一个名为 <code>source</code> 的分支或类似的分支中。\n我们也不需要像与项目网站一样，对链接添加前缀。</p>\n<p>这些站点的存储库需要一个特殊的名称。请参阅 <a href="https://help.github.com/articles/user-organization-and-project-pages/">https://help.github.com/articles/user-organization-and-project-pages/</a>  获取关于命名站点的存储库的文档。</p>\n<p>如果您希望将您的自定义域名与您的 <code>user.github.io</code> repo 连接起来，你需要在根目录层的 <code>static</code> 文件夹里的 <code>static</code> 种自定义域名 url，就像这样:</p>\n<div class="gatsby-highlight">\n      <pre class="language-none"><code>your-custom-domain.com</code></pre>\n      </div>\n<h2 id="gitlab-pages"><a href="#gitlab-pages" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Gitlab Pages</h2>\n<p>Gitlab Pages are similar to GitHub pages, perhaps even easier to setup. It also\nsupports custom domain names and SSL certificates. The process of setting GitLab\npages up is made a lot easier with GitLab’s included continuous integration\nplatform.</p>\n<p>Create a new GitLab repository, initialize your Gatsby project folder if you\nhaven’t already, and add the GitLab remote.</p>\n<div class="gatsby-highlight">\n      <pre class="language-none"><code>git init\ngit remote add origin git@gitlab.com:examplerepository\ngit add .\ngit push -u origin master</code></pre>\n      </div>\n<p>To use GitLab’s continuous integration (CI), you need to add a <code>.gitlab-ci.yml</code>\nconfiguration file. This can be added into your project folder, or once you have\npushed the repository, you can add it with GitLab’s website. The file needs to\ncontain a few required fields:</p>\n<div class="gatsby-highlight">\n      <pre class="language-none"><code>image: node:latest\n\n# This folder is cached between builds\n# http://docs.gitlab.com/ce/ci/yaml/README.html#cache\ncache:\n  paths:\n  - node_modules/\n\npages:\n  script:\n  - yarn install\n  - ./node_modules/.bin/gatsby build\n  artifacts:\n    paths:\n    - public\n  only:\n  - master</code></pre>\n      </div>\n<p>The CI platform uses Docker images/containers, so <code>image: node:latest</code> tells the\nCI to use the latest node image. <code>cache:</code> caches the <code>node_modules</code> folder\nin between builds, so subsequent builds should be a lot faster as it doesn’t have\nto reinstall all the dependancies required. <code>pages:</code> is the name of the\nCI stage. You can have multiple stages, e.g. ‘Test’, ‘Build’, ‘Deploy’ etc.\n<code>script:</code> starts the next part of the CI stage, telling it to start running the\nbelow scripts inside the image selected. We have used the <code>yarn install</code> and\n<code>./node_modules/.bin/gatsby build</code> which will install all dependancies, and\nstart the static site build, respectively. We have used\n<code>./node_modules/.bin/gatsby build</code> because we then don’t have to install\ngatsby-cli to build the image, as it has already been included and installed\nwith <code>yarn install</code>. <code>artifacts:</code> and <code>paths:</code> are used to tell GitLab pages\nwhere the static files are kept. <code>only:</code> and <code>master</code> tells the CI to only run\nthe above instructions when the master branch is deployed.</p>\n<p>Add that configuration, and with the next master branch push, your site should\nhave been built correctly. This can be checked by going to your repository on\nGitLab, and selecting CI/CD in the sidebar. This will then show you a log of all\njobs that have either succeeded or failed. You can click on the failed status,\nand then select the job to get more information about why your build may have\nfailed.</p>\n<p>If all went well, you should now be able to access your site. It will be hosted\nunder gitlab.io - for example if you have have a repository under your\nnamespace, the url will be yourname.gitlab.io/examplerepository.</p>\n<p>Visit the\n<a href="https://gitlab.com/help/user/project/pages/getting_started_part_one.md">GitLab Pages</a>\nto learn how to setup custom domains and find out about advanced configurations.</p>\n<h2 id="heroku"><a href="#heroku" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Heroku</h2>\n<p>You can use the <a href="https://github.com/heroku/heroku-buildpack-static">heroku buildpack static</a> to handle the static files of your site.</p>\n<p>Set the <code>heroku/node.js</code> and <code>heroku-buildpack-static</code> buildpacks on your application creating an <code>app.json</code> file on the root of your project.</p>\n<div class="gatsby-highlight">\n      <pre class="language-none"><code>{\n  "buildpacks": [\n    {\n      "url": "heroku/nodejs"\n    },\n    {\n      "url": "https://github.com/heroku/heroku-buildpack-static"\n    }\n  ]\n}</code></pre>\n      </div>\n<p>Sometimes specifying buildpacks via the <code>app.json</code> file doesn’t work. If this is your case try to add them in the Heroku dashboard or via the CLI.</p>\n<p>Add a <code>heroku-postbuild</code> script in your <code>package.json</code>:</p>\n<div class="gatsby-highlight">\n      <pre class="language-none"><code>{\n\n  // ...\n  "scripts": {\n    // ...\n    "heroku-postbuild": "gatsby build"\n    // ...\n  }\n  // ...\n}</code></pre>\n      </div>\n<p>Finally, add a <code>static.json</code> file in the root of your project to define the directory where your static assets will be. You can check all the options for this file in the <a href="https://github.com/heroku/heroku-buildpack-static#configuration">heroku-buildpack-static configuration</a>.</p>\n<div class="gatsby-highlight">\n      <pre class="language-none"><code>{\n  "root": "public/"\n}</code></pre>\n      </div>\n<h2 id="debugging-tips"><a href="#debugging-tips" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Debugging tips</h2>\n<h3 id="dont-minify-html"><a href="#dont-minify-html" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Don’t minify HTML</h3>\n<p>If you see the following error:</p>\n<div class="gatsby-highlight">\n      <pre class="language-none"><code>Unable to find element with ID ##</code></pre>\n      </div>\n<p>or alternatively</p>\n<div class="gatsby-highlight">\n      <pre class="language-none"><code>Uncaught Error: Minified React error #32; visit http://facebook.github.io/react/docs/error-decoder.html?invariant=32&args[]=## for the full message or use the non-minified dev environment for full errors and additional helpful warnings.</code></pre>\n      </div>\n<p>This is a new problem when dealing with static sites built with React. This is\nnot caused by Gatsby. React uses HTML comments to help identify locations of\ncomponents that do not render anything. If you are using a CDN that minifies\nyour HTML, it will eliminate the HTML comments used by React to take control of\nthe page on the client. Cloudflare is a CDN that minifies HTML by default.</p>',excerpt:"在不同的静态站点主机上部署的教程 S3/Cloudfront GitHub Pages GitLab Pages Heroku Amazon S3 and Cloudfront If you decide to host your Gatsby site on S3 with…",timeToRead:6,frontmatter:{title:"部署 Gatsby"},parent:{__typename:"File",relativePath:"docs/deploy-gatsby.md"}}},pathContext:{slug:"/docs/deploy-gatsby/"}}}});
//# sourceMappingURL=path---docs-deploy-gatsby-c400471e07581251b3e5.js.map